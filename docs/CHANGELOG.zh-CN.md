# 更新日志

Youwee 的所有重要更改都将记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/en/1.1.0/)，
本项目遵循 [语义化版本](https://semver.org/spec/v2.0.0.html)。

## [Unreleased]

### 修复
- **未安装 Homebrew 的 macOS 上应用崩溃** - 修复因缺少 `liblzma` 动态库导致的启动崩溃。`xz2` crate 现使用静态链接，使应用完全独立，无需 Homebrew 或系统库
- **自动下载忽略用户设置** - 频道自动下载现在使用每个频道的独立下载设置（视频/音频模式、画质、格式、编解码器、比特率），不再使用硬编码默认值。每个频道在频道设置面板中可单独配置下载偏好
- **安全加固** - FFmpeg 命令现使用结构化参数数组代替 shell 字符串解析，防止命令注入。为所有 yt-dlp 调用添加 URL scheme 验证和 `--` 分隔符以阻止选项注入。启用内容安全策略，移除过宽的 shell 权限，并为渲染链接添加 `isSafeUrl` 验证

## [0.9.0] - 2026-02-12

### 新增
- **频道关注与自动下载** - 关注 YouTube 频道，浏览视频，批量选择下载，支持完整的画质/编解码器/格式设置。后台轮询检测新上传并发送桌面通知，每频道显示新视频数量徽章。可折叠的关注频道面板，支持系统托盘最小化
- **大文件预览确认** - 可配置的文件大小阈值（默认 300MB），在处理页面加载大型视频前显示确认对话框。可在设置 → 通用 → 处理中调整阈值
- **多语言设置搜索** - 设置搜索现在支持所有语言。用中文搜索（如"主题"）或越南文搜索均可返回匹配结果。英文关键词始终作为后备方案

### 修复
- **Linux 上处理页面加载 4K VP9/AV1/HEVC 视频时白屏** - GStreamer 的 AAC 音频解码器在播放 VP9/AV1/HEVC 视频时导致 WebKitGTK 崩溃。预览现使用双元素方案：静音 H.264 视频 + 独立 WAV 音频通过 JavaScript 同步播放，完全绕过有问题的 AAC 路径。若视频播放仍失败，自动回退到静态 JPEG 缩略图。支持 macOS、Windows 和 Linux

## [0.8.2] - 2026-02-11

### 新增
- **多语言更新说明** - 更新对话框现在按用户语言显示发布说明（英文、越南文、中文）。CI 自动从对应语言的 CHANGELOG 文件中提取更新日志
- **通用下载支持 8K/4K/2K 画质** - 画质下拉菜单新增 8K 超高清、4K 超高清和 2K QHD 选项，与 YouTube 标签页一致。如果来源没有高分辨率格式，会自动降级到最高可用画质
- **通用下载"从头录制直播"开关** - 高级设置中新增开关，可从直播开头录制而非当前时间点。使用 yt-dlp 的 `--live-from-start` 参数
- **通用下载视频预览** - 添加 TikTok、Bilibili、Facebook、Instagram、Twitter 等网站的 URL 时自动显示缩略图、标题、时长和频道。缩略图也会保存到媒体库历史记录
- **更智能的平台识别** - 媒体库现在能正确识别和标记 yt-dlp 支持的 1800 多个网站（Bilibili、Dailymotion、SoundCloud 等），不再显示"其他"。新增 Bilibili 专用筛选标签

### 修复
- **Linux 上处理页面上传视频时冻结** - 视频文件通过 `readFile()` 被完整读入内存，导致内存溢出和白屏。现在使用 Tauri 的 asset 协议直接流式传输视频，无需加载到内存。同时添加错误边界防止白屏、带编解码器信息的视频错误处理、blob URL 清理防止内存泄漏、以及非 MP4 格式的正确 MIME 类型检测
- **媒体库中缩略图损坏** - 修复 Bilibili 等使用 HTTP URL 的网站缩略图。缩略图加载失败时现在会优雅地显示占位图标
- **切换页面时媒体库不刷新** - 媒体库现在在导航到页面时自动加载最新下载记录，无需手动刷新
